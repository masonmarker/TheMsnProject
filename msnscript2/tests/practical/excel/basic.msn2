# Performs basic Excel operations
#
# author : Mason Marker
# date : 6/3/2023

# obtains an existing Excel Workbook
@ book = excel('C:\\Users\\mason\\OneDrive\\Desktop\\book.xlsx')

# creates an Excel sheet
# (or gets it if it already exists)
@ sheet = book.sheet('sheet1')

# clear from last run
sheet.clear()

# creating a 2D array of cell
# numbers
@ cells = (
    [
        [0, 0], 
        [0, 1], 
        [0, 2], 
        [0, 3], 
        [0, 4],
        [1, 0], 
        [2, 0], 
        [3, 0],
        [4, 0]
    ])

# set each cell to 'hi!'
cells.each('cell', sheet.set(
    cell.get(0), 
    cell.get(1), 
    'hi!'
))

# assert the cells are all 'hi!'
cells.each('cell', assert(
    equals(sheet.get(
        cell.get(0),
        cell.get(1)
    ), 'hi!')
))

# assert an empty cell is None
assert(
    equals(sheet.get(10, 10), None),
    not(sheet.get(10, 10))
)


# getting populated columns and rows
assert(equals(
    sheet.column(0), 
    sheet.row(0),
    ['hi!', 'hi!', 'hi!', 'hi!', 'hi!']
))

# clear the sheet
sheet.clear()

# set a column of values
sheet.set_column(0, [1, 1, 1, 1, 1])

# assert the column is all 1s
assert(equals(
    sheet.column(0), 
    [1, 1, 1, 1, 1]
))

# set a row of values
sheet.set_row(0, [2, 2, 2, 2, 2])

# assert the row is all 2s
assert(equals(
    sheet.row(0), 
    [2, 2, 2, 2, 2]
))

# clears the sheet
sheet.clear()

# adding values to a column
5(sheet.add_to_column(3, 'hey'))

# assert the column is all 'hey'
assert(equals(
    sheet.column(3), 
    ['hey', 'hey', 'hey', 'hey', 'hey']
))

# clear the sheet
sheet.clear()

# adding values to a row
5(sheet.add_to_row(1, 'hey2'))

# assert the row is all 'hey'
assert(equals(
    sheet.row(1), 
    ['hey2', 'hey2', 'hey2', 'hey2', 'hey2']
))







# save the book
book.save()

# close the bookd
book.close()